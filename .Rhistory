tables("G")[c('table', 'description')] |> print(n = 40)
definitions() |> dplyr::filter(section == "Mental Health")
definitions() |> dplyr::filter(section == "Mental Health") |> print(n = 30)
tables("H")[c('table', 'description')] |> print(n = 40)
definitions() |> dplyr::filter(section == "Substance Abuse Treatment") |> print(n = 30)
tables("X")[c('table', 'description')] |> print(n = 40)
definitions() |> dplyr::filter(section == "New Technology") |> print(n = 30)
vctrs::vec_c(
"0" = "Introduction",
"1" = "Transfusion",
"2" = "Monitoring",
"5" = "Destruction",
"7" = "Dilation",
"A" = "Assistance",
"C" = "Extirpation",
"E" = "Measurement",
"G" = "Fusion",
"H" = "Insertion",
"J" = "Inspection",
"K" = "Bypass",
"P" = "Irrigation",
"R" = "Replacement",
"S" = "Reposition",
"U" = "Supplement",
"V" = "Restriction"
)
length(vctrs::vec_c(
"0" = "Introduction",
"1" = "Transfusion",
"2" = "Monitoring",
"5" = "Destruction",
"7" = "Dilation",
"A" = "Assistance",
"C" = "Extirpation",
"E" = "Measurement",
"G" = "Fusion",
"H" = "Insertion",
"J" = "Inspection",
"K" = "Bypass",
"P" = "Irrigation",
"R" = "Replacement",
"S" = "Reposition",
"U" = "Supplement",
"V" = "Restriction"
))
tables("X") |> print(n = 40)
tables("X") |> tidyr::unnest(codes)
tables("X") |> tidyr::unnest(codes) |> print(n = 300)
r0 <- vctrs::vec_c(
"0" = "Alteration",
"1" = "Bypass",
"2" = "Change",
"3" = "Control",
"4" = "Creation",
"5" = "Destruction",
"6" = "Detachment",
"7" = "Dilation",
"8" = "Division",
"9" = "Drainage",
"B" = "Excision",
"C" = "Extirpation",
"D" = "Extraction",
"F" = "Fragmentation",
"G" = "Fusion",
"H" = "Insertion",
"J" = "Inspection",
"K" = "Map",
"L" = "Occlusion",
"M" = "Reattachment",
"N" = "Release",
"P" = "Removal",
"Q" = "Repair",
"R" = "Replacement",
"S" = "Reposition",
"T" = "Resection",
"U" = "Supplement",
"V" = "Restriction",
"W" = "Revision",
"X" = "Transfer",
"Y" = "Transplantation"
)
t0 <- dplyr::tibble(
code = "0",
section = "Medical and Surgical",
axis = "3",
axis_code = names(r0),
label = r0
)
r1 <- vctrs::vec_c(
"2" = "Change",
"9" = "Drainage",
"A" = "Abortion",
"D" = "Extraction",
"E" = "Delivery",
"H" = "Insertion",
"J" = "Inspection",
"P" = "Removal",
"Q" = "Repair",
"S" = "Reposition",
"T" = "Resection",
"Y" = "Transplantation"
)
t1 <- dplyr::tibble(
code = "1",
section = "Obstetrics",
axis = "3",
axis_code = names(r1),
label = r1
)
r2 <- vctrs::vec_c(
"0" = "Change",
"1" = "Compression",
"2" = "Dressing",
"3" = "Immobilization",
"4" = "Packing",
"5" = "Removal",
"6" = "Traction"
)
t2 <- dplyr::tibble(
code = "2",
section = "Placement",
axis = "3",
axis_code = names(r2),
label = r2
)
r3 <- vctrs::vec_c(
"0" = "Introduction",
"1" = "Irrigation",
"2" = "Transfusion"
)
t3 <- dplyr::tibble(
code = "3",
section = "Administration",
axis = "3",
axis_code = names(r3),
label = r3
)
r4 <- vctrs::vec_c(
"0" = "Measurement",
"1" = "Monitoring"
)
t4 <- dplyr::tibble(
code = "4",
section = "Measurement and Monitoring",
axis = "3",
axis_code = names(r4),
label = r4
)
r5 <- vctrs::vec_c(
"0" = "Assistance",
"1" = "Performance",
"2" = "Restoration"
)
t5 <- dplyr::tibble(
code = "5",
section = "Extracorporeal or Systemic Assistance and Performance",
axis = "3",
axis_code = names(r5),
label = r5
)
r6 <- vctrs::vec_c(
"0" = "Atmospheric Control",
"1" = "Decompression",
"2" = "Electromagnetic Therapy",
"3" = "Hyperthermia",
"4" = "Hypothermia",
"5" = "Pheresis",
"6" = "Phototherapy",
"7" = "Ultrasound Therapy",
"8" = "Ultraviolet Light Therapy",
"9" = "Shockwave Therapy",
"B" = "Perfusion"
)
t6 <- dplyr::tibble(
code = "6",
section = "Extracorporeal or Systemic Therapies",
axis = "3",
axis_code = names(r6),
label = r6
)
t7 <- dplyr::tibble(
code = "7",
section = "Osteopathic",
axis = "3",
axis_code = "0",
label = "Treatment"
)
t8 <- dplyr::tibble(
code = "8",
section = "Other Procedures",
axis = "3",
axis_code = "0",
label = "Other Procedures"
)
t9 <- dplyr::tibble(
code = "9",
section = "Chiropractic",
axis = "3",
axis_code = "B",
label = "Manipulation"
)
rB <- vctrs::vec_c(
"0" = "Plain Radiography",
"1" = "Fluoroscopy",
"2" = "Computerized Tomography (CT Scan)",
"3" = "Magnetic Resonance Imaging (MRI)",
"4" = "Ultrasonography",
"5" = "Other Imaging"
)
tB <- dplyr::tibble(
code = "B",
section = "Imaging",
axis = "3",
axis_code = names(rB),
label = rB
)
rC <- vctrs::vec_c(
"1" = "Planar Nuclear Medicine Imaging",
"2" = "Tomographic (Tomo) Nuclear Medicine Imaging",
"3" = "Positron Emission Tomographic (PET) Imaging",
"4" = "Nonimaging Nuclear Medicine Uptake",
"5" = "Nonimaging Nuclear Medicine Probe",
"6" = "Nonimaging Nuclear Medicine Assay",
"7" = "Systemic Nuclear Medicine Therapy",
)
tC <- dplyr::tibble(
code = "C",
section = "Nuclear Medicine",
axis = "3",
axis_code = names(rC),
label = rC
)
rF <- vctrs::vec_c(
"0" = "Speech Assessment",
"1" = "Motor and/or Nerve Function Assessment",
"2" = "Activities of Daily Living Assessment",
"3" = "Hearing Assessment",
"4" = "Hearing Aid Assessment",
"5" = "Vestibular Assessment",
"6" = "Speech Treatment",
"7" = "Motor Treatment",
"8" = "Activities of Daily Living Treatment",
"9" = "Hearing Treatment",
"B" = "Cochlear Implant Treatment",
"C" = "Vestibular Treatment",
"D" = "Device Fitting",
"F" = "Caregiver Training"
)
tF <- dplyr::tibble(
code = "F",
section = "Physical Rehabilitation and Diagnostic Audiology",
axis = "3",
axis_code = names(rF),
label = rF
)
rG <- vctrs::vec_c(
"1" = "Psychological Tests",
"2" = "Crisis Intervention",
"3" = "Medication Management",
"5" = "Individual Psychotherapy",
"6" = "Counseling",
"7" = "Family Psychotherapy",
"B" = "Electroconvulsive Therapy",
"C" = "Biofeedback",
"F" = "Hypnosis",
"G" = "Narcosynthesis",
"H" = "Group Psychotherapy",
"J" = "Light Therapy",
)
tG <- dplyr::tibble(
code = "G",
section = "Mental Health",
axis = "3",
axis_code = names(rG),
label = rG
)
rH <- vctrs::vec_c(
"2" = "Detoxification Services",
"3" = "Individual Counseling",
"4" = "Group Counseling",
"5" = "Individual Psychotherapy",
"6" = "Family Counseling",
"8" = "Medication Management",
"9" = "Pharmacotherapy"
)
tH <- dplyr::tibble(
code = "H",
section = "Substance Abuse Treatment",
axis = "3",
axis_code = names(rH),
label = rH
)
rX <- length(vctrs::vec_c(
"0" = "Introduction",
"1" = "Transfusion",
"2" = "Monitoring",
"5" = "Destruction",
"7" = "Dilation",
"A" = "Assistance",
"C" = "Extirpation",
"E" = "Measurement",
"G" = "Fusion",
"H" = "Insertion",
"J" = "Inspection",
"K" = "Bypass",
"P" = "Irrigation",
"R" = "Replacement",
"S" = "Reposition",
"U" = "Supplement",
"V" = "Restriction"
))
tX <- dplyr::tibble(
code = "H",
section = "New Technology",
axis = "3",
axis_code = names(rH),
label = rH
)
root_ops <- vctrs::vec_rbind(t0, t1, t2, t3, t4, t5,
t6, t7, t8, t9, tB, tC,
tF, tG, tH, tX)
root_ops
dplyr::left_join(definitions(), root_ops) |>
dplyr::select(code,
section,
axis,
axis_name,
axis_code,
dplyr::everything())
definitions <- dplyr::left_join(definitions(), root_ops) |>
dplyr::select(code,
section,
axis,
axis_name,
axis_code,
dplyr::everything())
definitions
board <- pins::board_folder(here::here("pkgdown/assets/pins-board"))
board |> pins::pin_write(definitions,
name = "pcs_definitions_v2",
description = "ICD-10-PCS 2024 Definitions",
type = "qs")
board |> pins::write_board_manifest()
root_ops
systems()
tables("00")
tables("01")
grep("change", tables("01"), ignore.case = TRUE)
grep("change", tables("01")[c('description')], ignore.case = TRUE)
grep("change", tables("01")[c('description')], ignore.case = TRUE, value = TRUE)
pcs("0G9000Z")
pcs("2W1HX7Z")
axes()
axes("0")
library(procedural)
devtools::load_all(".")
mount_board()
pins::pin_list(mount_board())
devtools::load_all(".")
definitions()
definitions() |>
dplyr::count(code, section)
definitions() |>
#dplyr::count(code, section)
dplyr::filter(code == "0")
definitions() |>
dplyr::filter(code == "0") |>
dplyr::count(axis_code, label)
definitions() |>
dplyr::filter(code == "0") |>
dplyr::count(axis_code, label) |> print(n = Inf)
definitions() |>
dplyr::filter(code == "0") |>
dplyr::count(axis, axis_code, label) |> print(n = Inf)
pcs("2W0UX0Z")
pcs("2W20X4Z")
gc()
x <- "2W20X4Z"
xs <- splitter(x)
xs
tables <- pins::pin_read(mount_board(), "pcs_2024_tables")
pcs_2024 <- pins::pin_read(mount_board(), "pcs_2024")
vctrs::vec_slice(tables, tables$sec_code == xs[1])
tables <- vctrs::vec_slice(tables, tables$sec_code == xs[1])
vctrs::vec_slice(tables, tables$sys_code == xs[2])
tables <- vctrs::vec_slice(tables, tables$sys_code == xs[2])
vctrs::vec_slice(tables, tables$op_code == xs[3])
tables <- vctrs::vec_slice(tables, tables$op_code == xs[3])
vctrs::vec_slice(pcs_2024, pcs_2024$rowid >= min(tables$rowid) & pcs_2024$rowid <= max(tables$rowid))
pcs_2024 <- vctrs::vec_slice(pcs_2024, pcs_2024$rowid >= min(tables$rowid) & pcs_2024$rowid <= max(tables$rowid))
tables
tables$rowid <- NULL
dplyr::distinct(tables)
tables <- dplyr::distinct(tables)
dplyr::tibble(
axis = c(tables$sec_pos, tables$sys_pos, tables$op_pos),
name = unlist(axes(xs[1])[1:3, 2], use.names = FALSE),
code = c(tables$sec_code, tables$sys_code, tables$op_code),
label = c(tables$sec_lbl, tables$sys_lbl, tables$op_lbl))
dplyr::tibble(
axis = c(tables$sec_pos, tables$sys_pos, tables$op_pos),
n = collapser(axes(xs[1])[1:3, 2]),
name = unlist(axes(xs[1])[1:3, 2], use.names = FALSE),
code = c(tables$sec_code, tables$sys_code, tables$op_code),
label = c(tables$sec_lbl, tables$sys_lbl, tables$op_lbl))
axes(xs[1])[1:3, 2]
dplyr::tibble(
axis = c(tables$sec_pos, tables$sys_pos, tables$op_pos),
name = unlist(axes(xs[1])[1:3, 2], use.names = FALSE),
code = c(tables$sec_code, tables$sys_code, tables$op_code),
label = c(tables$sec_lbl, tables$sys_lbl, tables$op_lbl))
tables <- dplyr::tibble(
axis = c(tables$sec_pos, tables$sys_pos, tables$op_pos),
name = unlist(axes(xs[1])[1:3, 2], use.names = FALSE),
code = c(tables$sec_code, tables$sys_code, tables$op_code),
label = c(tables$sec_lbl, tables$sys_lbl, tables$op_lbl))
vctrs::vec_slice(pcs_2024, pcs_2024$code == xs[3])
ax4 <- vctrs::vec_slice(pcs_2024, pcs_2024$code == xs[3])
vctrs::vec_slice(ax4, ax4$axis_pos == "4")
ax4 <- vctrs::vec_slice(ax4, ax4$axis_pos == "4")
vctrs::vec_slice(ax4, ax4$axis_code == xs[4])
ax4 <- vctrs::vec_slice(ax4, ax4$axis_code == xs[4])
tidyr::drop_na(ax4)
ax4 <- tidyr::drop_na(ax4)
ax4$rowid <- NULL
dplyr::distinct(ax4)
ax4 <- dplyr::distinct(ax4)
dplyr::tibble(
axis = ax4$axis_pos,
name = ax4$axis_title,
code = ax4$axis_code,
label = ax4$axis_label)
ax4 <- dplyr::tibble(
axis = ax4$axis_pos,
name = ax4$axis_title,
code = ax4$axis_code,
label = ax4$axis_label)
vctrs::vec_slice(pcs_2024, pcs_2024$code == xs[3])
ax5 <- vctrs::vec_slice(pcs_2024, pcs_2024$code == xs[3])
vctrs::vec_slice(ax5, ax5$axis_pos == "5")
ax5 <- vctrs::vec_slice(ax5, ax5$axis_pos == "5")
vctrs::vec_slice(ax5, ax5$axis_code == xs[5])
ax5 <- vctrs::vec_slice(ax5, ax5$axis_code == xs[5])
ax5 <- tidyr::drop_na(ax5)
ax5$rowid <- NULL
dplyr::distinct(ax5)
ax5 <- dplyr::distinct(ax5)
dplyr::tibble(
axis = ax5$axis_pos,
name = ax5$axis_title,
code = ax5$axis_code,
label = ax5$axis_label)
ax5 <- dplyr::tibble(
axis = ax5$axis_pos,
name = ax5$axis_title,
code = ax5$axis_code,
label = ax5$axis_label)
ax6 <- vctrs::vec_slice(pcs_2024, pcs_2024$code == xs[3])
ax6 <- vctrs::vec_slice(ax6, ax6$axis_pos == "6")
ax6 <- vctrs::vec_slice(ax6, ax6$axis_code == xs[6])
ax6 <- tidyr::drop_na(ax6)
ax6$rowid <- NULL
ax6 <- dplyr::distinct(ax6)
dplyr::tibble(
axis = ax6$axis_pos,
name = ax6$axis_title,
code = ax6$axis_code,
label = ax6$axis_label)
ax6 <- dplyr::tibble(
axis = ax6$axis_pos,
name = ax6$axis_title,
code = ax6$axis_code,
label = ax6$axis_label)
ax7 <- vctrs::vec_slice(pcs_2024, pcs_2024$code == xs[3])
ax7 <- vctrs::vec_slice(ax7, ax7$axis_pos == "7")
ax7 <- vctrs::vec_slice(ax7, ax7$axis_code == xs[7])
ax7 <- tidyr::drop_na(ax7)
ax7$rowid <- NULL
ax7 <- dplyr::distinct(ax7)
dplyr::tibble(
axis = ax7$axis_pos,
name = ax7$axis_title,
code = ax7$axis_code,
label = ax7$axis_label)
ax7 <- dplyr::tibble(
axis = ax7$axis_pos,
name = ax7$axis_title,
code = ax7$axis_code,
label = ax7$axis_label)
vctrs::vec_rbind(tables, ax4, ax5, ax6, ax7)
gc()
devtools::load_all(".")
pcs("2W1HX7Z")
pcs("2W20X4Z")
pcs("2W2")
pcs("2W")
pcs("0G9")
pcs("0G90")
pcs("0G900")
class("0G900")
len("0G900")
length("0G900")
devtools::load_all(".")
pcs("0G")
devtools::load_all(".")
pcs("0G")
devtools::load_all(".")
pcs("0G")
pcs("0G1")
pcs("0G2")
tables()
library(procedural)
